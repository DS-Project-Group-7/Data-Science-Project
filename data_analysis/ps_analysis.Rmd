---
title: "Painting Support Analysis"
date: '2022-09-18'
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(dplyr)
art <- read.csv("../data/cleanData.csv")
art <- art %>%
  mutate(auxiliary_support_condition = recode(auxiliary_support_condition, "0" = "Poor", "1" = "Fair", "2" = "Good", "3" = "Excellent")) %>%
  mutate(media_condition = recode(media_condition, "0" = "Poor", "1" = "Fair", "2" = "Good", "3" = "Excellent")) %>%
  mutate(ground_condition = recode(ground_condition, "0" = "Poor", "1" = "Fair", "2" = "Good", "3" = "Excellent")) %>%
  mutate(painting_support_condition = recode(painting_support_condition, "0" = "Poor", "1" = "Fair", "2" = "Good", "3" = "Excellent")) %>%
  mutate(frame_condition = recode(frame_condition, "0" = "Poor", "1" = "Fair", "2" = "Good", "3" = "Excellent"))
```

```{r}
target_col <- c("collection", "auxiliary_support_condition", "media_condition", 
                "ground_condition", "painting_support_condition", "frame_condition")
conditions <- art[, target_col]
```

```{r}
# Test independence between museum collection and auxiliary support condition
aux_condition <- conditions %>%
  count(collection, auxiliary_support_condition)
aux_condition$collection <- factor(aux_condition$collection)
aux_condition$auxiliary_support_condition <- factor(aux_condition$auxiliary_support_condition)
aux_cond <- glm(n ~., data = aux_condition, family = poisson)
anova(aux_cond)
```

```{r}
1 - pchisq(8.198, 6)
```
Here, we would like to test if there's an association between the museum collection and the condition of the auxiliary support. As we can see from the deviance table above, the $\chi^2$ statistics is 8.198, which is less than $\chi^2_{0.95}(6)$ as the p-value 0.2240 indicates, hence we do not reject the hypothesis that there is no association between the museum collection and the condition of the auxiliary support.

```{r}
# Test independence between museum collection and painting support condition
ps_condition <- conditions %>%
  count(collection, painting_support_condition)
ps_cond <- glm(n ~ factor(collection) + factor(painting_support_condition), 
               data = ps_condition, family = poisson)
anova(ps_cond)
```

```{r}
1 - pchisq(4.87, 8)
```

In the seccond test, we would like to test if there's an association between the museum collection and the painting support condition. As we can see from the deviance table above, the $\chi^2$ statistics is 4.870, which is less than $\chi^2_{0.95}(8)$ as the p-value is less than the significant level of 0.05. Therefore, we do not reject the null hypothesis, and there's no association between museum collection and the painting support condition.
